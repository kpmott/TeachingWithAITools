%-------------------------------------------------------------------------------------------------------
% Beamer Style File
% Author: Kevin Mott (kevinpmott.com)
% Rotman School of Management, University of Toronto
% License: CC BY-NC 4.0 (https://creativecommons.org/licenses/by-nc/4.0/)
%
% A clean Beamer theme with UofT/Rotman colors. Customize colors and theme below.
%-------------------------------------------------------------------------------------------------------

%-------------------------------------------------------------------------------------------------------
% PACKAGES
% These are essential packages for math, graphics, and formatting.
% You likely won't need to change these unless adding specialized functionality.
%-------------------------------------------------------------------------------------------------------
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{tikz}
\usetikzlibrary{calc,positioning,arrows.meta}
\usepackage{hyperref}
\usepackage[most]{tcolorbox}
\usepackage{bbm}

%-------------------------------------------------------------------------------------------------------
% BEAMER THEME AND COLORS
% This section controls the overall look of your slides.
% CUSTOMIZE: Change colors to match your institution's branding.
% - usetheme: Controls the overall slide layout (Madrid is clean and professional)
% - definecolor: Define your institution's colors here
% - setbeamercolor: Apply those colors to different slide elements
%-------------------------------------------------------------------------------------------------------
\usetheme{Madrid}
\usecolortheme{default}

% Define your institution's colors here
% CUSTOMIZE: Replace these hex/RGB values with your school's brand colors
\definecolor{rotman}{HTML}{E20778}
\definecolor{darkgreen}{RGB}{30,175,88}
\definecolor{darkblue}{RGB}{30,118,175}
\definecolor{shadecolor}{RGB}{120,120,120}
\definecolor{uoftblue}{RGB}{0,42,92}      % UofT primary blue - used for headers
\definecolor{uoftteal}{RGB}{0,127,163}    % UofT accent teal - used for blocks

% Apply colors to slide elements
% CUSTOMIZE: Adjust which colors go where to match your preferences
\setbeamercolor{structure}{fg=uoftblue}
\setbeamercolor{frametitle}{bg=uoftblue,fg=white}
\setbeamercolor{title}{bg=uoftblue,fg=white}
\setbeamercolor{block title}{bg=uoftteal,fg=white}
\setbeamercolor{block body}{bg=uoftteal!10}

%-------------------------------------------------------------------------------------------------------
% NAVIGATION AND FOOTLINE
% Removes default Beamer navigation buttons (the small icons at bottom-right).
% Creates a clean three-part footer: author | title | slide number.
% CUSTOMIZE: Modify the footline template to change what appears at the bottom of each slide.
%-------------------------------------------------------------------------------------------------------
\setbeamertemplate{navigation symbols}{}

% Custom footline - shows author, title, and frame numbers with colored bar
% The footline is divided into three equal-width boxes (each 1/3 of page width)
\setbeamertemplate{footline}{
    \leavevmode%
    \hbox{%
        \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.5ex,dp=1ex,left,leftskip=.3cm]{author in head/foot}%
            \usebeamerfont{author in head/foot}\insertshortauthor
        \end{beamercolorbox}%
        \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.5ex,dp=1ex,center]{title in head/foot}%
            \usebeamerfont{title in head/foot}\insertshorttitle
        \end{beamercolorbox}%
        \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.5ex,dp=1ex,right,rightskip=.3cm]{date in head/foot}%
            \usebeamerfont{date in head/foot}\insertframenumber{} / \inserttotalframenumber
        \end{beamercolorbox}
    }%
    \vskip0pt%
}

%-------------------------------------------------------------------------------------------------------
% AUTOMATIC VERTICAL SPACING FOR BULLET POINTS
% This section automatically distributes bullet points evenly across the slide.
% Instead of bullets clustering at the top, they spread out to fill available space.
% Based on "Better Beamer" tweaks by Rob Williams (jayrobwilliams@gmail.com).
% Source: https://tex.stackexchange.com/questions/369504#369597
%
% HOW IT WORKS: Redefines itemize and enumerate environments to use \vfill
% between items, so content automatically expands to fill the slide vertically.
% You don't need to do anythingâ€”just use normal \begin{itemize}...\end{itemize}.
%-------------------------------------------------------------------------------------------------------
\makeatletter
\renewcommand{\itemize}[1][]{%
	\beamer@ifempty{#1}{}{\def\beamer@defaultospec{#1}}%
	\ifnum \@itemdepth >2\relax\@toodeep\else
	\advance\@itemdepth\@ne
	\ifnum \@itemdepth=1\relax\vfill\fi% Add vfill only for depth 1
	\beamer@computepref\@itemdepth% sets \beameritemnestingprefix
	\usebeamerfont{itemize/enumerate \beameritemnestingprefix body}%
	\usebeamercolor[fg]{itemize/enumerate \beameritemnestingprefix body}%
	\usebeamertemplate{itemize/enumerate \beameritemnestingprefix body begin}%
	\list
	{\usebeamertemplate{itemize \beameritemnestingprefix item}}
	{\def\makelabel##1{%
			{%
				\hss\llap{{%
						\usebeamerfont*{itemize \beameritemnestingprefix item}%
						\usebeamercolor[fg]{itemize \beameritemnestingprefix item}##1}}%
			}%
		}%
	}
	\fi%
	\setlength\itemsep{\fill}
	\ifnum \@itemdepth >1
	\vfill
	\fi%
	\beamer@cramped%
	\raggedright%
	\beamer@firstlineitemizeunskip%
}
\def\enditemize{\ifhmode\unskip\fi\endlist%
	\usebeamertemplate{itemize/enumerate \beameritemnestingprefix body end}
	\ifnum \@itemdepth >1
	\vfil
	\fi%
	\ifnum \@itemdepth=1\relax\vfill\fi% Add vfill only for depth 1
}
\makeatother

\makeatletter
\def\enumerate{%
	\ifnum\@enumdepth>2\relax\@toodeep
	\else%
	\advance\@enumdepth\@ne%
	\ifnum\@enumdepth=1\relax\vfill\fi% Add vfill only for depth 1
	\edef\@enumctr{enum\romannumeral\the\@enumdepth}%
	\advance\@itemdepth\@ne%
	\fi%
	\beamer@computepref\@enumdepth% sets \beameritemnestingprefix
	\edef\beamer@enumtempl{enumerate \beameritemnestingprefix item}%
	\@ifnextchar[{\beamer@@enum@}{\beamer@enum@}}
\def\beamer@@enum@[{\@ifnextchar<{\beamer@enumdefault[}{\beamer@@@enum@[}}
\def\beamer@enumdefault[#1]{\def\beamer@defaultospec{#1}%
	\@ifnextchar[{\beamer@@@enum@}{\beamer@enum@}}
\def\beamer@@@enum@[#1]{% partly copied from enumerate.sty
	\@enLab{}\let\@enThe\@enQmark
	\@enloop#1\@enum@
	\ifx\@enThe\@enQmark\@warning{The counter will not be printed.%
		^^J\space\@spaces\@spaces\@spaces The label is: \the\@enLab}\fi
	\def\insertenumlabel{\the\@enLab}
	\def\beamer@enumtempl{enumerate mini template}%
	\expandafter\let\csname the\@enumctr\endcsname\@enThe
	\csname c@\@enumctr\endcsname7
	\expandafter\settowidth
	\csname leftmargin\romannumeral\@enumdepth\endcsname
	{\the\@enLab\hspace{\labelsep}}%
	\beamer@enum@}
\def\beamer@enum@{%
	\beamer@computepref\@itemdepth% sets \beameritemnestingprefix
	\usebeamerfont{itemize/enumerate \beameritemnestingprefix body}%
	\usebeamercolor[fg]{itemize/enumerate \beameritemnestingprefix body}%
	\usebeamertemplate{itemize/enumerate \beameritemnestingprefix body begin}%
	\expandafter
	\list
	{\usebeamertemplate{\beamer@enumtempl}}
	{\usecounter\@enumctr%
		\def\makelabel##1{{\hss\llap{{%
						\usebeamerfont*{enumerate \beameritemnestingprefix item}%
						\usebeamercolor[fg]{enumerate \beameritemnestingprefix item}##1}}}}}%
	\setlength\itemsep{\fill}
	\ifnum \@itemdepth >1
	\vfill
	\fi%
	\beamer@cramped%
	\raggedright%
	\beamer@firstlineitemizeunskip%
}
\def\endenumerate{\ifhmode\unskip\fi\endlist%
	\usebeamertemplate{itemize/enumerate \beameritemnestingprefix body end}
	\ifnum \@itemdepth >1
	\vfil
	\fi%
	\ifnum\@enumdepth=1\relax\vfill\fi% Add vfill only for depth 1
}
\makeatother

%-------------------------------------------------------------------------------------------------------
% FONT SIZE ADJUSTMENTS
% Makes bullet point text larger and more readable from the back of a lecture hall.
% Also enlarges displayed equations so they're easier to see.
% CUSTOMIZE: Adjust \large, \normalsize, \Large to taste.
%-------------------------------------------------------------------------------------------------------
\setbeamerfont{itemize/enumerate body}{size=\large}
\setbeamerfont{itemize/enumerate subbody}{size=\large}
\setbeamerfont{itemize/enumerate subsubbody}{size=\normalsize}

% Make displayed equations (using \[ \] or equation*) larger
\usepackage{etoolbox}
\BeforeBeginEnvironment{equation*}{\begingroup\Large}
\AfterEndEnvironment{equation*}{\endgroup}